<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Script Generator - AmareItemLanguages</title>
    <style>
        :root {
            --primary-color: #4a90e2; /* A nice blue for dark mode */
            --secondary-color: #2c3e50; /* Darker element background */
            --border-color: #444;
            --text-color: #ecf0f1; /* Light text */
            --bg-color: #1e1e1e; /* Container background */
            --button-hover: #3a7bc8;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #121212; /* Dark page background */
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            width: 100%;
            max-width: 900px;
            background-color: var(--bg-color); /* Dark container background */
            padding: 30px; 
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 15px;
        }
        h6 {
            text-align: center;
            color: #95a5a6;
            font-weight: 400;
            margin-top: -15px;
            margin-bottom: 30px;
            font-style: italic;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        .form-group.full-width {
            grid-column: 1 / -1; /* Span across all columns */
        }
        .tab-container {
            margin-top: 20px;
        }
        .tab-buttons {
            display: flex;
            flex-wrap: wrap;
            border-bottom: 2px solid var(--border-color);
        }
        .tab-button {
            padding: 10px 15px;
            cursor: pointer;
            border: none;
            background-color: transparent;
            color: #bdc3c7;
            font-size: 14px;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px; /* Overlap with container border */
        }
        .tab-button.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            font-weight: bold;
        }
        .tab-panel {
            display: none;
            padding: 20px 5px;
            border-top: none;
        }
        .tab-panel.active {
            display: block;
        }
        .tab-panel .form-group {
            margin-bottom: 15px;
        }
        label {
            margin-bottom: 8px;
            font-weight: 600;
            color: #bdc3c7; /* Lighter grey for labels */
        }
        input[type="number"],
        input[type="text"],
        textarea {
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: #2c3e50;
            color: var(--text-color);
            font-size: 16px;
            width: 100%;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }
        input[type="number"]:focus,
        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 5px rgba(74, 144, 226, 0.3);
        }
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        .button-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
        }
        button {
            padding: 12px 25px;
            font-size: 16px;
            font-weight: bold;
            color: #fff;
            background-color: var(--primary-color);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        button:hover {
            background-color: var(--button-hover);
            transform: translateY(-2px);
        }
        .secondary-button {
            background-color: #7f8c8d;
        }
        .secondary-button:hover {
            background-color: #6c7a7b;
        }
        .danger-button {
            background-color: #c0392b;
            font-size: 12px;
            padding: 4px 8px;
        }
        .danger-button:hover {
            background-color: #a93226;
        }
        .history-container {
            width: 100%;
            max-width: 900px;
            margin-top: 20px;
            background-color: var(--bg-color);
            padding: 20px 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .history-container h3 {
            color: var(--primary-color);
            margin-top: 0;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }
        #historyList {
            list-style: none;
            padding: 0;
            margin: 0;
            max-height: 300px;
            overflow-y: auto;
        }
        #historyList li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        #historyList li:last-child {
            border-bottom: none;
        }
        #historyList .history-item-info {
            font-size: 14px;
            color: #bdc3c7;
        }
        .output-container {
            margin-top: 30px;
            position: relative;
        }
        #copyButton {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #5cb85c;
            font-size: 14px;
            padding: 8px 12px;
        }
        #copyButton:hover {
            background-color: #4cae4c;
        }
        pre {
            background-color: var(--secondary-color);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 20px;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 400px;
            overflow-y: auto;
        }
        code {
            font-family: "Courier New", Courier, monospace;
            font-size: 14px;
        }
        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #28a745;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.5s, transform 0.5s;
            visibility: hidden;
        }
        .notification.show {
            opacity: 1;
            transform: translate(-50%, -10px);
            visibility: visible;
        }
        footer {
            width: 100%;
            max-width: 900px;
            margin-top: auto; /* Pushes footer to the bottom */
            text-align: center;
            padding-top: 20px;
            color: #7f8c8d;
            font-size: 14px;
            border-top: 1px solid var(--border-color);
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>AmareItemLanguages Script Generator</h1>
                
        <div class="form-grid">
            <div class="form-group full-width">
                <label for="regionSelect">Country</label>
                <select id="regionSelect" style="padding: 12px; border: 1px solid var(--border-color); border-radius: 5px; background-color: #2c3e50; color: var(--text-color); font-size: 16px; width: 100%; box-sizing: border-box;">
                    <option value="europe">Europe</option>
                    <option value="turkish">Turkish</option>
                    <option value="all">All</option>
                </select>
            </div>
        </div>

        <div class="form-grid">
            <div class="form-group">
                <label for="itemId">ItemID</label>
                <input type="number" id="itemId" placeholder="e.g., 743">
            </div>
            <div class="form-group">
                <label for="itemDescription">ItemDescription</label>
                <input type="text" id="itemDescription" placeholder="e.g., Restore">
            </div>
        </div>

        <div id="tabs-container" class="tab-container">
            <!-- Tabs will be generated here by JavaScript -->
        </div>
        
        <div class="button-container">
            <button id="generateButton">Generate Scripts</button>
            <button id="clearButton" class="secondary-button">Clear All Fields</button>
        </div>

        <div class="output-container">
            <button id="copyButton" style="display:none;">Copy</button>
            <pre><code id="output">-- Generated scripts will be displayed here...</code></pre>
        </div>
    </div>

    <div class="history-container">
        <h3>History</h3>
        <ul id="historyList">
            <!-- History items will be populated here -->
        </ul>
    </div>

    <div id="copyNotification" class="notification">Copied to clipboard!</div>

    <footer>
        <p>Tool created by Orlando Calvo</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const languageDataSets = {
                europe: [
                    { id: 6, name: 'French' }, { id: 18, name: 'Dutch' }, { id: 203, name: 'Czech Republic' },
                    { id: 214, name: 'English - Great Britain' }, { id: 226, name: 'English-Luxembourg' },
                    { id: 227, name: 'German - Austria' }, { id: 228, name: 'German - Switzerland' },
                    { id: 229, name: 'German - Liechtenstein' }, { id: 231, name: 'Italian - Italy' },
                    { id: 232, name: 'Spanish - Spain' }, { id: 233, name: 'Hungarian - Hungary' },
                    { id: 235, name: 'English - Ireland' }, { id: 237, name: 'Romanian - Romania' },
                    { id: 238, name: 'Dutch - Belgium' }
                ],
                turkish: [
                    { id: 225, name: 'English-Turkey' }
                ],
                all: [
                    { id: 0, name: 'English' }, { id: 1, name: 'Spanish' }, { id: 2, name: 'German' },
                    { id: 3, name: 'Korean' }, { id: 4, name: 'Belorussian' }, { id: 5, name: 'Japanese' },
                    { id: 6, name: 'French' }, { id: 7, name: 'Mandarin' }, { id: 8, name: 'Chinese-Taiwan' },
                    { id: 9, name: 'Thai' }, { id: 10, name: 'Tagalec-Phillipino' }, { id: 11, name: 'Hungarian' },
                    { id: 12, name: 'Finnish' }, { id: 13, name: 'Norsk' }, { id: 14, name: 'Malay' },
                    { id: 15, name: 'Indonesian' }, { id: 16, name: 'Portuguese' }, { id: 17, name: 'Italian' },
                    { id: 18, name: 'Dutch' }, { id: 19, name: 'Russian' }, { id: 20, name: 'Slovakia' },
                    { id: 21, name: 'Cyrillic' }, { id: 22, name: 'Estonian' }, { id: 23, name: 'Bulgarian' },
                    { id: 24, name: 'Vietnamese' }, { id: 25, name: 'Polish' }, { id: 26, name: 'Swedish' },
                    { id: 27, name: 'Turkish' }, { id: 61, name: 'Tamil – India' }, { id: 62, name: 'Hindi – India' },
                    { id: 65, name: 'Hebrew-Israel' }, { id: 66, name: 'Greek - Greece' }, { id: 80, name: 'English - Malaysia' },
                    { id: 81, name: 'Chinese - Malaysia' }, { id: 82, name: 'Malay' }, { id: 83, name: 'English - Serbia' },
                    { id: 84, name: 'Serbian' }, { id: 85, name: 'English - Latvia' }, { id: 86, name: 'Latvian' },
                    { id: 87, name: 'English - Puerto Rico' }, { id: 89, name: 'English - Thailand' },
                    { id: 91, name: 'English - Taiwan' }, { id: 93, name: 'English - Brazil' },
                    { id: 94, name: 'Portuguese - Brazil' }, { id: 203, name: 'Czech Republic' },
                    { id: 204, name: 'Chinese (Simplified)' }, { id: 205, name: 'Chinese (Traditional)' },
                    { id: 206, name: 'English - India' }, { id: 207, name: 'English - United Arab Emirates' },
                    { id: 208, name: 'French – Canada' }, { id: 209, name: 'Croatian' }, { id: 210, name: 'Lithuanian' },
                    { id: 211, name: 'Romanian' }, { id: 212, name: 'Danish' }, { id: 213, name: 'English - United States' },
                    { id: 214, name: 'English - Great Britain' }, { id: 215, name: 'English - Canada' },
                    { id: 216, name: 'Icelandic' }, { id: 217, name: 'Spanish-United States' },
                    { id: 218, name: 'Spanish-DominicanReplubic' }, { id: 219, name: 'Spanish-Mexico' },
                    { id: 220, name: 'Spanish-Guatemala' }, { id: 221, name: 'English-Ireland' },
                    { id: 222, name: 'Chinese - US' }, { id: 223, name: 'Chinese - Australia' },
                    { id: 224, name: 'English - Australia' }, { id: 225, name: 'English-Turkey' },
                    { id: 226, name: 'English-Luxembourg' }, { id: 227, name: 'German - Austria' },
                    { id: 228, name: 'German - Switzerland' }, { id: 229, name: 'German - Liechtenstein' },
                    { id: 230, name: 'German - Germany' }, { id: 231, name: 'Italian - Italy' },
                    { id: 232, name: 'Spanish - Spain' }, { id: 233, name: 'Hungarian - Hungary' },
                    { id: 235, name: 'English - Ireland' }, { id: 236, name: 'English - Romania' },
                    { id: 237, name: 'Romanian - Romania' }, { id: 238, name: 'Dutch - Belgium' },
                    { id: 239, name: 'English - Singapore' }, { id: 240, name: 'English - Philippines' },
                    { id: 241, name: 'Chinese (Traditional) - Hong Kong' }
                ]
            };

            let currentGroupedLanguages = [];
            const generateButton = document.getElementById('generateButton');
            const copyButton = document.getElementById('copyButton');
            const outputCode = document.getElementById('output');
            const tabsContainer = document.getElementById('tabs-container');
            const historyList = document.getElementById('historyList');
            const clearButton = document.getElementById('clearButton');
            const regionSelect = document.getElementById('regionSelect');

            function setupTabs(groupedLanguages) {
                tabsContainer.innerHTML = ''; // Clear existing tabs
                if (groupedLanguages.length === 0) return;

                const tabButtons = document.createElement('div');
                tabButtons.className = 'tab-buttons';
                const tabContent = document.createElement('div');
                tabContent.className = 'tab-content';

                groupedLanguages.forEach((group, index) => {
                    const groupId = group.ids.join(',');
                    const displayName = group.ids.length > 1 ? `${group.name} (${group.ids.join(', ')})` : group.name;

                    const button = document.createElement('button');
                    button.className = 'tab-button';
                    button.textContent = displayName;
                    button.dataset.langIds = groupId;
                    tabButtons.appendChild(button);

                    const panel = document.createElement('div');
                    panel.className = 'tab-panel';
                    panel.dataset.langIds = groupId;
                    panel.innerHTML = `
                        <div class="form-group">
                            <label for="shortDetail-${groupId}">ShortDetail</label>
                            <textarea id="shortDetail-${groupId}" data-field="shortDetail" placeholder="Enter ShortDetail for ${group.name}..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="longDetail-${groupId}">LongDetail (HTML allowed)</label>
                            <textarea id="longDetail-${groupId}" data-field="longDetail" placeholder="Enter LongDetail for ${group.name}..."></textarea>
                        </div>
                    `;
                    tabContent.appendChild(panel);

                    if (index === 0) {
                        button.classList.add('active');
                        panel.classList.add('active');
                    }
                });

                tabsContainer.appendChild(tabButtons);
                tabsContainer.appendChild(tabContent);

                tabButtons.addEventListener('click', (e) => {
                    if (e.target.classList.contains('tab-button')) {
                        const targetLangIds = e.target.dataset.langIds;
                        
                        tabButtons.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                        tabContent.querySelectorAll('.tab-panel').forEach(pnl => pnl.classList.remove('active'));

                        e.target.classList.add('active');
                        tabContent.querySelector(`.tab-panel[data-lang-ids="${targetLangIds}"]`).classList.add('active');
                    }
                });
            }

            function updateLanguageUI(region) {
                const languages = languageDataSets[region] || [];
                
                const grouped = languages.reduce((acc, lang) => {
                    const baseName = lang.name.split(' - ')[0].replace('-', ' ');
                    let group = acc.find(g => g.name === baseName);
                    if (!group) {
                        group = { name: baseName, ids: [], originalNames: [] };
                        acc.push(group);
                    }
                    group.ids.push(lang.id);
                    group.originalNames.push(lang.name);
                    return acc;
                }, []);

                grouped.sort((a, b) => a.name.localeCompare(b.name));
                currentGroupedLanguages = grouped;
                setupTabs(currentGroupedLanguages);
            }

            // Function to escape single quotes for SQL
            const escapeSql = (str) => str.replace(/'/g, "''");

            const STORAGE_KEY = 'amareScriptHistory_v2'; // Changed key for new data structure

            const renderHistory = () => {
                historyList.innerHTML = '';
                const history = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
                if (history.length === 0) {
                    historyList.innerHTML = '<li>No history yet.</li>';
                    return;
                }

                history.forEach(item => {
                    const li = document.createElement('li');
                    const date = new Date(item.timestamp).toLocaleString();
                    li.innerHTML = `
                        <span class="history-item-info"><strong>ID:</strong> ${item.itemId} - <em>${date}</em></span>
                        <div>
                            <button class="secondary-button load-btn" data-timestamp="${item.timestamp}">Load</button>
                            <button class="danger-button delete-btn" data-timestamp="${item.timestamp}">Delete</button>
                        </div>
                    `;
                    historyList.appendChild(li);
                });
            };

            const saveToHistory = (data) => {
                let history = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
                history.unshift(data);
                if (history.length > 20) {
                    history.pop();
                }
                localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
                renderHistory();
            };

            const loadFromHistory = (timestamp) => {
                const history = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
                const item = history.find(h => h.timestamp == timestamp);
                if (item) {
                    document.getElementById('itemId').value = item.itemId;
                    document.getElementById('itemDescription').value = item.itemDescription;
                    
                    // Clear all textareas first
                    document.querySelectorAll('textarea').forEach(ta => ta.value = '');

                    item.languageData.forEach(groupData => {
                        const groupId = groupData.ids.join(',');
                        const shortDetailEl = document.getElementById(`shortDetail-${groupId}`);
                        const longDetailEl = document.getElementById(`longDetail-${groupId}`);
                        if (shortDetailEl) shortDetailEl.value = groupData.shortDetail;
                        if (longDetailEl) longDetailEl.value = groupData.longDetail;
                    });
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            };

            const deleteFromHistory = (timestamp) => {
                let history = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
                history = history.filter(h => h.timestamp != timestamp);
                localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
                renderHistory();
            };

            generateButton.addEventListener('click', () => {
                const itemId = document.getElementById('itemId').value;
                const itemDescription = document.getElementById('itemDescription').value;

                if (!itemId) {
                    alert('Please enter an ItemID.');
                    return;
                }

                let scripts = `-- Scripts generated for ItemID: ${itemId}\n\n`;
                let scriptGenerated = false;
                const languageDataForHistory = [];
                
                currentGroupedLanguages.forEach(group => {
                    const groupId = group.ids.join(',');
                    const shortDetail = document.getElementById(`shortDetail-${groupId}`).value;
                    let longDetail = document.getElementById(`longDetail-${groupId}`).value;

                    if (shortDetail.trim() !== '') {
                        scriptGenerated = true;
                        languageDataForHistory.push({
                            ids: group.ids,
                            shortDetail: shortDetail,
                            longDetail: longDetail
                        });

                        const trimmedLongDetail = longDetail.trim();
                        if (trimmedLongDetail && !trimmedLongDetail.startsWith('<p>') && !trimmedLongDetail.endsWith('</p>')) {
                            longDetail = `<p>${trimmedLongDetail}</p>`;
                        }

                        group.ids.forEach((langId, index) => {
                            const originalName = group.originalNames[index];
                            scripts += `-- Language: ${originalName} (${langId})\n`;
                            scripts += `INSERT INTO [AmareReporting].[ExigoWebContext].[AmareItemLanguages] 
    ([ItemID], [LanguageID], [ItemDescription], [ShortDetail], [LongDetail])
VALUES 
    (${itemId}, ${langId}, N'${escapeSql(itemDescription)}', N'${escapeSql(shortDetail)}', N'${escapeSql(longDetail)}');\n\n`;
                        });
                    }
                });

                if (scriptGenerated) {
                    const historyEntry = {
                        timestamp: Date.now(),
                        itemId: itemId,
                        itemDescription: itemDescription,
                        languageData: languageDataForHistory
                    };
                    saveToHistory(historyEntry);
                }

                if (!scriptGenerated) {
                    scripts += '-- No content was entered in any language tab. No scripts generated.';
                }

                outputCode.textContent = scripts;
                copyButton.style.display = 'block';
            });

            copyButton.addEventListener('click', () => {
                navigator.clipboard.writeText(outputCode.textContent).then(() => {
                    const notification = document.getElementById('copyNotification');
                    notification.classList.add('show');
                    setTimeout(() => {
                        notification.classList.remove('show');
                    }, 2000);
                }).catch(err => {
                    console.error('Error copying text: ', err);
                    alert('Could not copy the text.');
                });
            });

            historyList.addEventListener('click', (e) => {
                const timestamp = e.target.dataset.timestamp;
                if (e.target.classList.contains('load-btn')) {
                    loadFromHistory(timestamp);
                }
                if (e.target.classList.contains('delete-btn')) {
                    if (confirm('Are you sure you want to delete this history item?')) {
                        deleteFromHistory(timestamp);
                    }
                }
            });

            clearButton.addEventListener('click', () => {
                document.getElementById('itemId').value = '';
                document.getElementById('itemDescription').value = '';
                document.querySelectorAll('textarea').forEach(ta => ta.value = '');
            });

            regionSelect.addEventListener('change', (e) => {
                updateLanguageUI(e.target.value);
            });

            renderHistory(); // Initial render on page load
            updateLanguageUI(regionSelect.value); // Initial UI setup based on default region
        });
    </script>

</body>
</html>
>
